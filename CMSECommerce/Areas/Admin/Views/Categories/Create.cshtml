@model Category

@{
    ViewData["Title"] = "Create Category";
}

<h1 class="mb-4 display-6 fw-bold text-dark">Create Category</h1>

<div class="row">
    <div class="col-md-6">
        <form asp-action="Create" class="p-4 border rounded shadow-lg bg-light">

            <div asp-validation-summary="ModelOnly" class="alert alert-danger" role="alert"></div>

            <div class="form-group mb-3">
                <label asp-for="Name" class="control-label fw-bold">Category Name</label>
                <input asp-for="Name" class="form-control" id="nameInput" />
                <span asp-validation-for="Name" class="text-danger"></span>
            </div>

            <div class="form-group mb-3">
                <label asp-for="ParentId" class="control-label fw-bold">Parent Category (optional)</label>
                <select asp-for="ParentId" asp-items="(IEnumerable<SelectListItem>)ViewBag.ParentCategories" class="form-select"></select>
                <span asp-validation-for="ParentId" class="text-danger"></span>
            </div>

            <div class="form-group mb-3">
                <label class="control-label fw-bold">Slug (auto-generated)</label>
                <input type="text" readonly class="form-control" id="slugDisplay" placeholder="Generated from name when saved" />
                <input type="hidden" asp-for="Slug" id="slugInput" />
            </div>

            <div class="d-flex justify-content-between pt-3">
                <a asp-action="Index" class="btn btn-outline-secondary">
                    <i class="fas fa-arrow-left"></i> Back to List
                </a>
                <button type="submit" class="btn btn-warning fw-bold shadow-sm">
                    <i class="fas fa-save"></i> Create
                </button>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script>
        document.getElementById('nameInput').addEventListener('input', function() {
            var name = this.value;
            var slug = name.toLowerCase().replace(/[^a-z0-9\s-]/g, '').replace(/\s+/g, '-').replace(/-+/g, '-').trim('-');
            document.getElementById('slugDisplay').value = slug;
            document.getElementById('slugInput').value = slug;
        });
    </script>
}
