@* Bulk Product Upload View: /Areas/Admin/Views/Products/BulkCreate.cshtml *@

@{
    ViewData["Title"] = "Bulk Product Upload";
}

<style>
    /* Custom Amazon-style colors for consistency */
    .amazon-orange {
        /* Signature Amazon Orange */
        background-color: #FF9900;
        border-color: #FF9900;
        color: #131921; /* Dark Amazon text color */
        font-weight: bold;
    }

        .amazon-orange:hover {
            background-color: #ffb74d;
            border-color: #ffb74d;
        }

    /* Secondary button style (e.g., Cancel) - often dark gray/blue */
    .btn-secondary-amazon {
        background-color: #4a5568;
        border-color: #4a5568;
        color: #FFFFFF;
    }

        .btn-secondary-amazon:hover {
            background-color: #5d687b;
            border-color: #5d687b;
            color: #FFFFFF;
        }

    /* Information Alert styled with orange accent */
    .alert-info-amazon {
        background-color: #fff9e6; /* Very light yellow/cream background */
        border: 1px solid #FF9900; /* Orange border all around */
        border-radius: 6px;
        padding: 15px;
    }

    .file-format-pre {
        background-color: #ffffff; /* White background for the code/table block */
        border: 1px dashed #DDDDDD; /* Light gray dashed border */
        padding: 15px;
        border-radius: 4px;
        overflow-x: auto;
        font-family: Consolas, monospace;
        font-size: 0.9rem;
    }

    /* Text input styling to look cleaner/flatter */
    .form-control {
        border-radius: 3px;
    }

</style>

<div class="d-flex justify-content-between align-items-end mb-4 border-bottom pb-2">
    <h1 class="display-5 fw-normal text-dark">Bulk Product Upload</h1>
</div>

<p class="mb-4">
    Use this page to upload a large number of products simultaneously using a single Excel (.xlsx) file.
    Products will automatically be assigned the default **"noimage.png"** and set to the **"Approved"** status.
</p>

<div class="alert alert-info-amazon shadow-sm mb-4">
    <h5 class="fw-bold text-dark">Required File Format:</h5>
    <p class="mb-2">Ensure your data starts in **Row 2** and follows this exact column order:</p>

    <div class="file-format-pre">
        | **Column A (Index 0)** | **Column B (Index 1)** | **Column C (Index 2)** | **Column D (Index 3)** |
        |---|---|---|---|
        | Name | Description | Price | Category Name |
        | Laptop Pro X | Fast, 15-inch screen. | 1299.99 | Electronics |
        | T-Shirt Blue | 100% Cotton, size medium. | 25.00 | Clothing |
    </div>

    <ul class="mt-3 mb-0 small ps-4">
        <li>**Row 1** must contain the headers shown above.</li>
        <li>**Category Name** must exactly match an existing category in the database.</li>
        <li>**Price** must be a valid numerical value (e.g., 12.50).</li>
    </ul>
</div>

<form method="post" enctype="multipart/form-data" asp-action="BulkCreate">
    @* Display validation summary or controller errors *@
    <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

    <div class="form-group mb-4">
        <label for="excelFile" class="form-label fw-bold">Select Product Excel File (.xlsx)</label>
        <input type="file" id="excelFile" name="excelFile" class="form-control" accept=".xlsx" required />
    </div>

    <div class="d-flex justify-content-start gap-2">
        <button type="submit" class="btn amazon-orange shadow-sm">
            <i class="fas fa-upload me-1"></i> Upload and Create Products
        </button>
        <a asp-action="Index" class="btn btn-secondary-amazon">
            <i class="fas fa-arrow-left me-1"></i> Cancel
        </a>
    </div>
</form>