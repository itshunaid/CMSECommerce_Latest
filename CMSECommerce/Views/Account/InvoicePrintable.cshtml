@model OrderDetailsViewModel
@using System.Globalization
@{
 Layout = null; // Standalone printable page
 var indianCulture = new CultureInfo("en-IN");
}
<!DOCTYPE html>
<html>
<head>
 <meta charset="utf-8" />
 <meta name="viewport" content="width=device-width, initial-scale=1.0" />
 <title>Invoice #@Model.Order.Id</title>
 <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
 <style>
 body { background: white; color: #111; font-family: Arial, sans-serif; }
 .invoice-wrapper { max-width:900px; margin: auto; padding:20px; }
 .x-small { font-size:0.75rem; }
 </style>
 <script>
 window.addEventListener('DOMContentLoaded', function () {
 var autoPrint = '@(ViewData["AutoPrint"] ?? "true")';
 if (autoPrint === 'True' || autoPrint === 'true') {
 window.print();
 }
 });
 </script>
</head>
<body>
 <div class="invoice-wrapper">
 <h3>Final Details for Order #@Model.Order.Id</h3>
 <p class="x-small">Order Placed: @Model.Order.OrderDate.Value.ToString("MMMM dd, yyyy")</p>
 <hr />
 <div class="row">
 <div class="col-6">
 <h6 class="fw-bold">Shipping Address</h6>
 <div class="x-small">
 <p class="mb-0 fw-bold">@Model.UserProfile?.FirstName @Model.UserProfile?.LastName</p>
 <p class="mb-0">@Model.UserProfile?.HomeAddress</p>
 <p class="mb-0">Phone: @Model.UserProfile?.HomePhoneNumber</p>
 </div>
 </div>
 <div class="col-6 text-end">
 <h6 class="fw-bold">Order Summary</h6>
 <div class="x-small">
 <div class="d-flex justify-content-between">
 <span>Grand Total:</span>
 <span>@Model.Order.GrandTotal.ToString("C", indianCulture)</span>
 </div>
 </div>
 </div>
 </div>

 <table class="table table-borderless mt-3">
 <thead>
 <tr>
 <th>Item</th>
 <th class="text-center">Price</th>
 <th class="text-center">Qty</th>
 <th class="text-end">Total</th>
 </tr>
 </thead>
 <tbody>
 @foreach(var item in Model.OrderDetails)
 {
 <tr>
 <td>@item.Product.Name</td>
 <td class="text-center">@item.Price.ToString("C", indianCulture)</td>
 <td class="text-center">@item.Quantity</td>
 <td class="text-end">@((item.Price * item.Quantity).ToString("C", indianCulture))</td>
 </tr>
 }
 </tbody>
 </table>

 <div class="text-center mt-4 x-small">To save as PDF: use your browser's Print -> Save as PDF</div>
 </div>
</body>
</html>