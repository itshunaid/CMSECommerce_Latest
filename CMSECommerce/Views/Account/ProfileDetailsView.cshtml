@using CMSECommerce.Areas.Admin.Models
@model EditUserModel

@{
    ViewData["Title"] = "Profile Details";
}

<style>
    /* LinkedIn-Style CSS Definitions */
    :root {
        --linkedin-blue: #0A66C2;
        --linkedin-gray: #EBEBEB;
        --text-dark: #191919;
        --text-secondary: #666666;
        --shadow-subtle: 0 0 0 1px rgb(0 0 0 / 15%), 0 2px 3px rgb(0 0 0 / 20%);
        --business-gold: #B87333; /* Distinct color for Business Section */
    }

    .linkedin-card {
        background-color: #fff;
        border-radius: 12px;
        margin-bottom: 20px;
        border: 1px solid var(--linkedin-gray);
        position: relative;
        overflow: hidden;
    }

    .profile-hero {
        background: linear-gradient(to right, #0A66C2, #004182);
        height: 150px;
        position: relative;
    }

    .profile-photo {
        width: 130px;
        height: 130px;
        border-radius: 50%;
        border: 4px solid #fff;
        position: absolute;
        top: 85px;
        left: 25px;
        z-index: 10;
        object-fit: cover;
        box-shadow: 0 0 0 1px rgba(0,0,0,.15);
    }

    .main-info {
        padding: 75px 24px 24px 24px;
        position: relative;
    }

    .main-name {
        font-size: 28px;
        font-weight: 600;
        color: var(--text-dark);
        margin-bottom: 4px;
    }

    .main-profession {
        font-size: 18px;
        color: var(--text-dark);
        margin-bottom: 8px;
    }

    .main-role {
        font-size: 16px;
        color: var(--text-secondary);
        margin-bottom: 15px;
    }

    .section-header {
        font-size: 20px;
        font-weight: 600;
        color: var(--text-dark);
        border-bottom: 1px solid var(--linkedin-gray);
        padding-bottom: 8px;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
    }

    .detail-label {
        font-size: 13px;
        color: var(--text-secondary);
        margin-top: 10px;
        display: block;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .detail-value {
        font-size: 16px;
        color: var(--text-dark);
        margin-bottom: 10px;
    }

    .linkedin-btn {
        background-color: var(--linkedin-blue);
        color: #fff;
        border-radius: 20px;
        padding: 8px 16px;
        font-weight: 600;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        transition: 0.2s;
    }

        .linkedin-btn:hover {
            background-color: #004182;
            color: #fff;
        }

    .qr-code-display {
        max-width: 100px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-top: 5px;
    }

    /* NEW: Business Badge Styling */
    .business-badge {
        background-color: #f8faff;
        border: 1px solid #dce6f1;
        padding: 10px;
        border-radius: 8px;
        margin-top: 10px;
    }
</style>

<div class="d-flex justify-content-between align-items-center mb-4">
    <h2 style="font-weight: 400; color: var(--text-dark);">User Profile Details</h2>

    @if (User.IsInRole("Admin") || User.Identity.Name == Model.UserName)
    {
        <a asp-action="ProfileDetails"
           asp-controller="Account"
           asp-route-id="@Model.Id"
           class="linkedin-btn">
            <i class="fas fa-pencil-alt me-2"></i> Edit Profile
        </a>
    }
</div>

<div class="row">
    <div class="col-lg-8">
        @* HERO CARD *@
        <div class="linkedin-card">
            <div class="profile-hero"></div>
            <img src="@(string.IsNullOrEmpty(Model.ProfileImagePath) ? "/images/default_profile.png" : Model.ProfileImagePath)"
                 alt="Profile Photo" class="profile-photo">

            <div class="main-info">
                <div class="d-flex justify-content-end mb-3">
                    <span class="badge @(Model.IsProfileVisible ? "bg-success" : "bg-warning text-dark")">
                        @(Model.IsProfileVisible ? "Visible to Public" : "Private")
                    </span>
                </div>

                <div class="main-name">@Model.FirstName @Model.LastName</div>
                <div class="main-profession">@(string.IsNullOrEmpty(Model.Profession) ? "Profession Not Listed" : Model.Profession)</div>
                <div class="main-role"><i class="fas fa-user-tag me-1"></i> @Model.Role</div>

                @if (!string.IsNullOrEmpty(Model.StoreName))
                {
                    <div class="business-badge">
                        <span class="text-secondary small d-block">Operating as:</span>
                        <strong class="text-primary"><i class="fas fa-store me-1"></i> @Model.StoreName</strong>
                    </div>
                }
            </div>
        </div>

        @* STORE / BUSINESS DETAILS CARD *@
        <div class="linkedin-card p-4" style="border-top: 4px solid var(--business-gold);">
            <div class="section-header">
                <i class="fas fa-briefcase me-2 text-primary"></i> Business & Store Information
            </div>
            <div class="row">
                <div class="col-md-6">
                    <span class="detail-label">Legal Store Name</span>
                    <div class="detail-value">@(Model.StoreName ?? "Not Set")</div>

                    <span class="detail-label">GSTIN</span>
                    <div class="detail-value">@(string.IsNullOrEmpty(Model.GSTIN) ? "Not Provided" : Model.GSTIN)</div>
                </div>
                <div class="col-md-6">
                    <span class="detail-label">Business Contact Email</span>
                    <div class="detail-value">@(Model.StoreEmail ?? "Not Set")</div>

                    <span class="detail-label">Business Phone</span>
                    <div class="detail-value">@(Model.StoreContact ?? "Not Set")</div>
                </div>
                <div class="col-12 mt-2">
                    <span class="detail-label">Store Location</span>
                    <div class="detail-value">
                        <i class="fas fa-map-marked-alt text-secondary me-1"></i>
                        @Model.StoreStreetAddress, @Model.StoreCity, @Model.StorePostCode, @Model.StoreCountry
                    </div>
                </div>
            </div>
        </div>

        <div class="linkedin-card p-4">
            <div class="section-header">About</div>
            <div class="detail-value" style="white-space: pre-wrap;">
                @(string.IsNullOrEmpty(Model.About) ? "No 'About' section provided yet." : Model.About)
            </div>
        </div>

        <div class="linkedin-card p-4">
            <div class="section-header">Services & Skills</div>
            <div class="detail-value">
                @(string.IsNullOrEmpty(Model.ServicesProvided) ? "No services listed." : Model.ServicesProvided)
            </div>
        </div>
    </div>

    @* RIGHT SIDEBAR *@
    <div class="col-lg-4">
        <div class="linkedin-card p-4">
            <div class="section-header">Personal Contact</div>

            <span class="detail-label">Login Email</span>
            <div class="detail-value">@Model.Email</div>

            <span class="detail-label">Primary Phone</span>
            <div class="detail-value">@(string.IsNullOrEmpty(Model.PhoneNumber) ? "Not Set" : Model.PhoneNumber)</div>

            @if (!string.IsNullOrEmpty(Model.ITSNumber))
            {
                <span class="detail-label">ITS Number</span>
                <div class="detail-value">@Model.ITSNumber</div>
            }

            <span class="detail-label">Home Address</span>
            <div class="detail-value">@(string.IsNullOrEmpty(Model.HomeAddress) ? "Not Set" : Model.HomeAddress)</div>
        </div>

        <div class="linkedin-card p-4">
            <div class="section-header">Social Media & Links</div>
            @* (LinkedIn, Facebook, Instagram loops remain same as your provided code) *@
            @if (!string.IsNullOrEmpty(Model.LinkedInUrl))
            {
                <span class="detail-label"><i class="fab fa-linkedin text-primary"></i> LinkedIn</span>
                <div class="detail-value"><a href="@Model.LinkedInUrl" target="_blank" class="btn btn-sm btn-outline-primary">View Profile</a></div>
            }
            <span class="detail-label"><i class="fab fa-whatsapp text-success"></i> WhatsApp</span>
            <div class="detail-value">@(string.IsNullOrEmpty(Model.WhatsAppNumber) ? "Not Set" : Model.WhatsAppNumber)</div>
        </div>

        <div class="linkedin-card p-4">
            <div class="section-header">Verification & Payments</div>

            <span class="detail-label">Identity Approval</span>
            <div class="detail-value">
                @if (Model.IsImageApproved)
                {
                    <span class="badge bg-success"><i class="fas fa-check-circle"></i> Profile Verified</span>
                }
                else
                {
                    <span class="badge bg-secondary">Pending Verification</span>
                }
            </div>

            <div class="row mt-3">
                <div class="col-6">
                    <span class="detail-label">GPay QR</span>
                    @if (!string.IsNullOrEmpty(Model.GpayQRCodePath))
                    {
                        <img src="@Model.GpayQRCodePath" class="qr-code-display" />
                    }
                    else
                    {

                        <div class="small text-muted">Not Set</div>
                    }
                </div>
                <div class="col-6">
                    <span class="detail-label">PhonePe QR</span>
                    @if (!string.IsNullOrEmpty(Model.PhonePeQRCodePath))
                    {
                        <img src="@Model.PhonePeQRCodePath" class="qr-code-display" />
                    }
                    else
                    {

                        <div class="small text-muted">Not Set</div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>