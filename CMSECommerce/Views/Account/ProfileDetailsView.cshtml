@using CMSECommerce.Areas.Admin.Models
@model EditUserModel

@{
    ViewData["Title"] = "Profile Details";
}

<style>
    /* LinkedIn-Style CSS Definitions */
    :root {
        --linkedin-blue: #0A66C2;
        --linkedin-gray: #EBEBEB;
        --text-dark: #191919;
        --text-secondary: #666666;
        --shadow-subtle: 0 0 0 1px rgb(0 0 0 / 15%), 0 2px 3px rgb(0 0 0 / 20%);
        --business-gold: #B87333;
    }

    .linkedin-card {
        background-color: #fff;
        border-radius: 12px;
        margin-bottom: 20px;
        border: 1px solid var(--linkedin-gray);
        position: relative;
        overflow: hidden;
    }

    .profile-hero {
        background: linear-gradient(to right, #0A66C2, #004182);
        height: 150px;
        position: relative;
    }

    .profile-photo {
        width: 130px;
        height: 130px;
        border-radius: 50%;
        border: 4px solid #fff;
        position: absolute;
        top: 85px;
        left: 25px;
        z-index: 10;
        object-fit: cover;
        box-shadow: 0 0 0 1px rgba(0,0,0,.15);
    }

    .main-info {
        padding: 75px 24px 24px 24px;
        position: relative;
    }

    .main-name {
        font-size: 28px;
        font-weight: 600;
        color: var(--text-dark);
        margin-bottom: 4px;
    }

    .main-profession {
        font-size: 18px;
        color: var(--text-dark);
        margin-bottom: 8px;
    }

    .section-header {
        font-size: 18px;
        font-weight: 600;
        color: var(--text-dark);
        border-bottom: 1px solid var(--linkedin-gray);
        padding-bottom: 8px;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
    }

    .detail-label {
        font-size: 12px;
        font-weight: 700;
        color: var(--text-secondary);
        margin-top: 12px;
        display: block;
        text-transform: uppercase;
    }

    .detail-value {
        font-size: 15px;
        color: var(--text-dark);
        margin-bottom: 5px;
    }

    .linkedin-btn {
        background-color: var(--linkedin-blue);
        color: #fff;
        border-radius: 20px;
        padding: 8px 16px;
        font-weight: 600;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        transition: 0.2s;
    }

        .linkedin-btn:hover {
            background-color: #004182;
            color: #fff;
        }

    .qr-code-display {
        max-width: 100px;
        border: 1px solid #ddd;
        border-radius: 8px;
        margin-top: 5px;
        padding: 5px;
        background: white;
    }

    .business-badge {
        background-color: #f8faff;
        border: 1px solid #dce6f1;
        padding: 12px;
        border-radius: 8px;
        margin-top: 15px;
    }

    .social-icon-btn {
        font-size: 20px;
        margin-right: 15px;
        transition: transform 0.2s;
        display: inline-block;
    }

        .social-icon-btn:hover {
            transform: scale(1.2);
        }
</style>

<div class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 style="font-weight: 600; color: var(--text-dark);">Account Overview</h2>

        @if (User.IsInRole("Admin") || User.Identity.Name == Model.UserName)
        {
            <a asp-action="ProfileDetails"
               asp-controller="Account"
               asp-route-id="@Model.Id"
               class="linkedin-btn">
                <i class="fas fa-edit me-2"></i> Edit Profile
            </a>
        }
    </div>

    <div class="row">
        @* LEFT COLUMN: Main Profile & Business *@
        <div class="col-lg-8">
            @* HERO CARD *@
            <div class="linkedin-card">
                <div class="profile-hero"></div>
                <img src="@Model.ProfileImagePath" alt="Profile Photo" class="profile-photo">

                <div class="main-info">
                    <div class="d-flex justify-content-end mb-3">
                        <span class="badge @(Model.IsProfileVisible ? "bg-success" : "bg-warning text-dark")">
                            <i class="fas @(Model.IsProfileVisible ? "fa-eye" : "fa-eye-slash") me-1"></i>
                            @(Model.IsProfileVisible ? "Public Profile" : "Private Profile")
                        </span>
                    </div>

                    <div class="main-name">@Model.FirstName @Model.LastName</div>
                    <div class="main-profession">@(Model.Profession ?? "Professional")</div>
                    <div class="text-muted mb-3"><i class="fas fa-user-tag me-1"></i> @Model.Role</div>

                    @if (!string.IsNullOrEmpty(Model.StoreName) && Model.StoreName != "No Store Assigned")
                    {
                        <div class="business-badge">
                            <span class="text-secondary small d-block mb-1">Affiliated Business:</span>
                            <strong class="text-primary" style="font-size: 1.1rem;">
                                <i class="fas fa-store-alt me-2"></i>@Model.StoreName
                            </strong>
                        </div>
                    }
                </div>
            </div>

            @* BUSINESS DETAILS *@
            <div class="linkedin-card p-4">
                <div class="section-header" style="color: var(--business-gold);">
                    <i class="fas fa-building me-2"></i> Business & Store Details
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <span class="detail-label">Tax ID / GSTIN</span>
                        <div class="detail-value">@(Model.GSTIN ?? "Not Provided")</div>

                        <span class="detail-label">Business Email</span>
                        <div class="detail-value">@(Model.StoreEmail ?? "Not Provided")</div>
                    </div>
                    <div class="col-md-6">
                        <span class="detail-label">Business Phone</span>
                        <div class="detail-value">@(Model.StoreContact ?? "Not Provided")</div>

                        <span class="detail-label">Location</span>
                        <div class="detail-value">
                            @if (!string.IsNullOrEmpty(Model.StoreCity))
                            {
                                <text>@Model.StoreStreetAddress, @Model.StoreCity, @Model.StoreCountry</text>
                            }
                            else
                            {
                                <text>Address not listed</text>
                            }
                        </div>
                    </div>
                </div>
            </div>

            @* ABOUT SECTION *@
            <div class="linkedin-card p-4">
                <div class="section-header">About</div>
                <div class="detail-value" style="white-space: pre-wrap; line-height: 1.6;">
                    @(string.IsNullOrEmpty(Model.About) ? "This user hasn't written a bio yet." : Model.About)
                </div>
            </div>

            @* SERVICES *@
            <div class="linkedin-card p-4">
                <div class="section-header">Services Provided</div>
                <div class="d-flex flex-wrap gap-2">
                    @if (!string.IsNullOrEmpty(Model.ServicesProvided))
                    {
                        @foreach (var service in Model.ServicesProvided.Split(','))
                        {
                            <span class="badge bg-light text-dark border p-2">@service.Trim()</span>
                        }
                    }
                    else
                    {
                        <span class="text-muted italic">No services listed.</span>
                    }
                </div>
            </div>
        </div>

        @* RIGHT COLUMN: Contact & Social *@
        <div class="col-lg-4">
            @* CONTACT CARD *@
            <div class="linkedin-card p-4">
                <div class="section-header">Contact Information</div>

                <span class="detail-label">Email Address</span>
                <div class="detail-value text-primary">@Model.Email</div>

                <span class="detail-label">Mobile Number</span>
                <div class="detail-value">@(Model.PhoneNumber ?? "Not Provided")</div>

                @if (!string.IsNullOrEmpty(Model.ITSNumber))
                {
                    <span class="detail-label">ITS Number</span>
                    <div class="detail-value">@Model.ITSNumber</div>
                }

                <hr />

                <span class="detail-label">Home Address</span>
                <div class="detail-value small">@(Model.HomeAddress ?? "Not Provided")</div>

                <span class="detail-label">Work Address</span>
                <div class="detail-value small">@(Model.BusinessAddress ?? "Not Provided")</div>
            </div>

            @* SOCIAL MEDIA *@
            <div class="linkedin-card p-4 text-center">
                <div class="section-header justify-content-center">Social Profiles</div>
                <div class="mt-2">
                    @if (!string.IsNullOrEmpty(Model.WhatsAppNumber))
                    {
                        <a href="https://wa.me/@Model.WhatsAppNumber" target="_blank" class="social-icon-btn text-success">
                            <i class="fab fa-whatsapp"></i>
                        </a>
                    }
                    @if (!string.IsNullOrEmpty(Model.LinkedInUrl))
                    {
                        <a href="@Model.LinkedInUrl" target="_blank" class="social-icon-btn text-primary">
                            <i class="fab fa-linkedin"></i>
                        </a>
                    }
                    @if (!string.IsNullOrEmpty(Model.FacebookUrl))
                    {
                        <a href="@Model.FacebookUrl" target="_blank" class="social-icon-btn text-primary">
                            <i class="fab fa-facebook"></i>
                        </a>
                    }
                    @if (!string.IsNullOrEmpty(Model.InstagramUrl))
                    {
                        <a href="@Model.InstagramUrl" target="_blank" class="social-icon-btn text-danger">
                            <i class="fab fa-instagram"></i>
                        </a>
                    }
                </div>
            </div>

            @* VERIFICATION & QR *@
            <div class="linkedin-card p-4">
                <div class="section-header">Payments & Trust</div>

                <div class="mb-4">
                    <span class="detail-label">Status</span>
                    @if (Model.IsImageApproved)
                    {
                        <span class="badge bg-success w-100 py-2"><i class="fas fa-check-circle me-1"></i> Verified Profile</span>
                    }
                    else
                    {
                        <span class="badge bg-secondary w-100 py-2">Verification Pending</span>
                    }
                </div>

                <div class="row g-2 text-center">
                    <div class="col-6">
                        <span class="detail-label">GPay</span>
                        @if (!string.IsNullOrEmpty(Model.GpayQRCodePath) && !Model.GpayQRCodePath.Contains("default"))
                        {
                            <img src="@Model.GpayQRCodePath" class="qr-code-display" />
                        }
                        else
                        {
                            <div class="small text-muted border rounded p-3 mt-2">N/A</div>
                        }
                    </div>
                    <div class="col-6">
                        <span class="detail-label">PhonePe</span>
                        @if (!string.IsNullOrEmpty(Model.PhonePeQRCodePath) && !Model.PhonePeQRCodePath.Contains("default"))
                        {
                            <img src="@Model.PhonePeQRCodePath" class="qr-code-display" />
                        }
                        else
                        {
                            <div class="small text-muted border rounded p-3 mt-2">N/A</div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>